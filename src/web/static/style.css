:root {
  /* Color System - Premium Glass Dark */
  --bg-base: #0f0f12; /* Deep space dark */
  --bg-sidebar: rgba(20, 20, 25, 0.7); /* Translucent */
  --bg-surface: rgba(40, 40, 50, 0.4); /* Glassy panels */
  --bg-hover: rgba(255, 255, 255, 0.08);
  --bg-active: rgba(255, 255, 255, 0.12);

  --border-subtle: rgba(255, 255, 255, 0.08);
  --border-highlight: rgba(255, 255, 255, 0.15);

  --text-primary: #f0f0f5;
  --text-secondary: #a1a1aa;
  --text-tertiary: #71717a;

  /* Accent - Neon Mint & Blurple */
  --accent-primary: #10b981; /* Emerald */
  --accent-glow: rgba(16, 185, 129, 0.4);
  --accent-secondary: #6366f1; /* Indigo */

  /* Spacing */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-6: 1.5rem;

  /* Radii */
  --radius-sm: 6px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Z-Indices */
  --z-background: 0;
  --z-surface: 10;
  --z-sticky: 50;
  --z-overlay: 100;
  --z-modal: 1000;
}

/* Reset & Base */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--bg-base);
  background-image:
    radial-gradient(
      circle at 10% 20%,
      rgba(99, 102, 241, 0.1) 0%,
      transparent 40%
    ),
    radial-gradient(
      circle at 90% 80%,
      rgba(16, 185, 129, 0.08) 0%,
      transparent 40%
    );
  color: var(--text-primary);
  font-family:
    "Inter",
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    Helvetica,
    Arial,
    sans-serif;
  font-size: 14px;
  line-height: 1.5;
  height: 100vh;
  display: flex;
  overflow: hidden;
}

/* Typography */
h1,
h2,
h3,
h4 {
  color: var(--text-primary);
  font-weight: 600;
  letter-spacing: -0.02em;
}

p {
  color: var(--text-secondary);
  margin-bottom: var(--space-4);
}

/* App Shell */
.app-shell {
  display: flex;
  width: 100%;
  height: 100%;
}

/* Sidebar - Glassy & Collapsible */
.sidebar {
  width: 260px;
  background-color: var(--bg-sidebar);
  border-right: 1px solid var(--border-subtle);
  backdrop-filter: blur(20px);
  display: flex;
  flex-direction: column;
  padding: var(--space-2);
  flex-shrink: 0;
  transition: width 0.3s cubic-bezier(0.2, 0, 0, 1);
  position: relative;
  z-index: var(--z-sticky);
}

.sidebar.collapsed {
  width: 68px;
}

.sidebar-header {
  height: 60px;
  padding: 0 var(--space-2);
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-2);
}

.logo {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding-left: var(--space-2);
  overflow: hidden;
  white-space: nowrap;
}

.logo-symbol {
  font-family: "Cinzel", serif;
  font-size: 24px;
  background: linear-gradient(135deg, #fff 0%, #a1a1aa 100%);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.logo-text {
  font-weight: 600;
  font-size: 16px;
  transition: opacity 0.2s;
}

.sidebar.collapsed .logo-text,
.sidebar.collapsed .sidebar-toggle {
  display: none; /* In collapsed mode, toggle is handled by a different mechanism or implicit click, or we keep it visible? */
}

/* Re-thinking toggle: A small button always visible */
.sidebar-toggle {
  background: transparent;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: 6px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.sidebar-toggle:hover {
  color: var(--text-primary);
  background: var(--bg-hover);
}

.sidebar.collapsed .sidebar-header {
  justify-content: center;
  padding: 0;
}

/* Actually, let's keep the logo only in full mode, or symbol only in collapsed */
.sidebar.collapsed .logo {
  padding-left: 0;
  justify-content: center;
  width: 100%;
}

.sidebar.collapsed .logo-text {
  display: none;
}

/* We need a way to toggle BACK when collapsed. 
   Usually the toggle button moves or we use the logo as toggle? 
   Let's keep the toggle button visible but maybe moved. 
   Or just click the sidebar/header to expand? 
   Standard pattern: Toggle button stays. 
*/
.sidebar.collapsed .sidebar-toggle {
  display: flex;
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
}

/* Logo is also clickable to expand when collapsed */
.sidebar.collapsed .logo {
  cursor: pointer;
}

/* Nav Items */
.sidebar-nav {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: 10px 12px;
  border-radius: var(--radius-md);
  color: var(--text-secondary);
  background: transparent;
  border: 1px solid transparent;
  cursor: pointer;
  font-size: 14px;
  text-align: left;
  white-space: nowrap;
  overflow: hidden;
  transition: all 0.2s;
  height: 42px;
}

.nav-item:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.nav-item.active {
  background-color: var(--bg-active);
  color: var(--text-primary);
  border-color: var(--border-subtle);
}

.nav-item.action-primary {
  color: var(--text-primary);
  border: 1px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.03);
}

.nav-item.action-primary:hover {
  border-color: var(--border-highlight);
  background: rgba(255, 255, 255, 0.08);
}

.nav-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

.nav-label {
  flex: 1;
  opacity: 1;
  transition: opacity 0.2s;
}

.sidebar.collapsed .nav-label {
  opacity: 0;
  width: 0;
  display: none;
}

.sidebar.collapsed .nav-item {
  padding: 10px;
  justify-content: center;
}

/* Sidebar Divider */
.sidebar-divider {
  height: 1px;
  background: var(--border-subtle);
  margin: var(--space-2) 0;
  flex-shrink: 0;
}

/* History Section */
.sidebar-section {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  margin-top: var(--space-2);
}

/* Custom Scrollbar for Sidebar */
.sidebar-section::-webkit-scrollbar {
  width: 4px;
}
.sidebar-section::-webkit-scrollbar-track {
  background: transparent;
}
.sidebar-section::-webkit-scrollbar-thumb {
  background: var(--bg-hover);
  border-radius: 2px;
}

.section-label {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-weight: 600;
  color: var(--text-tertiary);
  padding: var(--space-2) 12px;
  white-space: nowrap;
}

.sidebar.collapsed .section-label {
  display: none;
}

.history-item {
  font-size: 13px;
  padding: 6px 8px 6px 12px;
  margin: 0 4px;
  border-radius: var(--radius-sm);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: all 0.2s;
}

.history-item-title {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

.history-delete-btn {
  display: none;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: 16px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  flex-shrink: 0;
  transition: all 0.15s;
  line-height: 1;
}

.history-item:hover .history-delete-btn {
  display: flex;
}

.history-delete-btn:hover {
  background: rgba(239, 68, 68, 0.2);
  color: #ef4444;
}

.history-item:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.history-item.active {
  background: var(--bg-active);
  color: var(--text-primary);
}

.sidebar.collapsed .history-item {
  display: none; /* Hide history in collapsed mode to keep it clean */
}

/* Regenerate Button */
.regenerate-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-top: 8px;
  padding: 5px 12px;
  border: 1px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.03);
  color: var(--text-secondary);
  font-size: 12px;
  font-family: var(--font-body);
  border-radius: var(--radius-full);
  cursor: pointer;
  transition: all 0.2s;
}

.regenerate-btn:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: var(--border-highlight);
  color: var(--text-primary);
}

.regenerate-btn svg {
  opacity: 0.7;
}

.regenerate-btn:hover svg {
  opacity: 1;
}

/* Footer & Status */
.sidebar-footer {
  padding-top: var(--space-2);
  border-top: 1px solid var(--border-subtle);
}

.footer-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: 10px 12px;
  width: 100%;
  border-radius: var(--radius-md);
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
}

.footer-item:hover {
  color: var(--text-primary);
  background: var(--bg-hover);
}

.footer-icon {
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.sidebar.collapsed .footer-label {
  display: none;
}

.sidebar.collapsed .footer-item {
  justify-content: center;
}

.system-status {
  padding: 8px 12px;
  margin-top: 4px;
}

.status-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
}

.status-dot {
  width: 8px;
  height: 8px;
  background-color: var(--accent-primary);
  border-radius: 50%;
  box-shadow: 0 0 8px var(--accent-glow);
}

.status-dot.running {
  background-color: #fbbf24; /* Amber for working */
  box-shadow: 0 0 8px rgba(251, 191, 36, 0.4);
  animation: pulse-dot 1.5s infinite;
}

@keyframes pulse-dot {
  0% {
    transform: scale(0.9);
    opacity: 0.7;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
  100% {
    transform: scale(0.9);
    opacity: 0.7;
  }
}

.status-text {
  font-size: 12px;
  color: var(--text-tertiary);
  white-space: nowrap;
}

.sidebar.collapsed .status-text {
  display: none;
}

.sidebar.collapsed .system-status {
  display: flex;
  justify-content: center;
  padding: 8px 0;
}

/* Main Content */
.main-content {
  flex-grow: 1; /* This fills the "dead space" automatically */
  display: flex;
  flex-direction: column;
  background: transparent; /* Let body gradient show through */
  min-width: 0; /* Prevent flex overflow */
  position: relative; /* Keep for absolute children like input-nexus */
  overflow: hidden; /* Ensure content doesn't spill out */
  overflow-x: auto; /* Prevents text from bleeding out */
  padding: 20px; /* Consistent spacing from the sidebar edge */
  margin-left: 0 !important; /* Forces the gap to close */
  width: auto;               /* Ensures it doesn't shrink */
  align-items: stretch;     /* Ensures logs fill the width */
}

/* View Handling */
.view {
  display: none;
  flex-direction: column;
  flex: 1; /* Take up all remaining space */
  width: 100%;
  min-height: 0; /* Crucial for scrolling inside flex item */
  opacity: 0;
  transform: translateY(10px);
  transition:
    opacity 0.3s ease,
    transform 0.3s ease;
  z-index: var(--z-surface);
} 

.view.active {
  display: flex !important;
  opacity: 1;
  transform: translateY(0);
}

/* Chat Viewport */
.chat-viewport {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  align-items: stretch; /* Stretch items */
  padding-bottom: 140px; /* Space for input */
  scroll-behavior: smooth;
  width: 100%;
}

/* ... headers ... */

/* Messages */
.message-list {
  width: 100%;
  max-width: none; /* Let it fill */
  margin: 0;
  display: flex;
  flex-direction: column;
  padding: 20px;
}

.message {
  padding: var(--space-4) 0;
  width: 100%;
  display: flex;
  gap: var(--space-4);
}

.message-avatar {
  width: 32px;
  height: 32px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 14px;
  flex-shrink: 0;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

.message.agent .message-avatar {
  background: linear-gradient(135deg, var(--accent-primary) 0%, #059669 100%);
  color: white;
}

.message.user .message-avatar {
  background: linear-gradient(135deg, var(--accent-secondary) 0%, #4f46e5 100%);
  color: white;
}

.message-bubble-wrapper {
  flex: 1;
  max-width: 100%;
}

.message-bubble {
  font-size: 15px;
  line-height: 1.6;
  color: var(--text-primary);
  white-space: pre-wrap;
}

.message.user .message-bubble {
  color: var(--text-primary);
}

.message-status {
  font-size: 10px;
  color: var(--text-tertiary);
  margin-top: 4px;
}

/* Code Blocks */
.code-block-wrapper {
  margin: 4px 0;
  border-radius: 4px;
  background: #111113;
  border: 1px solid var(--border-subtle);
  overflow: hidden;
  max-width: 100%;
}

.code-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 2px 8px;
  background: rgba(255, 255, 255, 0.02);
  border-bottom: 1px solid var(--border-subtle);
}

.code-lang {
  font-size: 9px;
  text-transform: uppercase;
  color: var(--text-tertiary);
  font-family: var(--font-mono);
  letter-spacing: 0.02em;
}

.code-copy-btn {
  background: transparent;
  border: none;
  color: var(--text-tertiary);
  font-size: 9px;
  display: flex;
  align-items: center;
  gap: 3px;
  cursor: pointer;
  padding: 1px 4px;
  border-radius: 3px;
}

.code-copy-btn svg {
  width: 10px;
  height: 10px;
}

.code-copy-btn:hover {
  background: rgba(255, 255, 255, 0.04);
  color: var(--text-secondary);
}

.message-bubble pre {
  margin: 0;
  padding: 4px 8px;
  overflow-x: auto;
  font-size: 10.5px;
  line-height: 1.3;
  max-height: 200px;
  overflow-y: auto;
}

.code-copy-btn.copied {
  color: var(--accent-primary);
  background: rgba(16, 185, 129, 0.1);
}

.code-block-wrapper pre {
  padding: 16px;
  overflow-x: auto;
  margin: 0;
}

/* Override highlight.js background to match Delta theme */
.code-block-wrapper pre code.hljs {
  background: transparent;
  padding: 0;
}

.code-block-wrapper code {
  font-family: "JetBrains Mono", "Fira Code", monospace;
  font-size: 13px;
  line-height: 1.6;
  color: #e4e4e7;
  tab-size: 4;
}

/* ... Input Nexus ... */

/* Markdown Content Styling within Bubbles */
.message-bubble h1,
.message-bubble h2,
.message-bubble h3,
.message-bubble h4 {
  margin-top: 16px;
  margin-bottom: 8px;
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.3;
}

.message-bubble h1 { font-size: 1.4em; border-bottom: 1px solid var(--border-subtle); padding-bottom: 4px; }
.message-bubble h2 { font-size: 1.25em; }
.message-bubble h3 { font-size: 1.1em; }
.message-bubble h4 { font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); }

.message-bubble p {
  margin-bottom: 12px;
  line-height: 1.6;
}

.message-bubble p:last-child {
  margin-bottom: 0;
}

.message-bubble ul,
.message-bubble ol {
  margin: 8px 0 16px 20px;
  padding: 0;
}

.message-bubble li {
  margin-bottom: 4px;
  padding-left: 4px;
}

.message-bubble li::marker {
  color: var(--accent-secondary);
}

.message-bubble blockquote {
  border-left: 3px solid var(--accent-primary);
  background: rgba(16, 185, 129, 0.05);
  margin: 12px 0;
  padding: 8px 16px;
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
  font-style: italic;
  color: var(--text-secondary);
}

.message-bubble a {
  color: var(--accent-primary);
  text-decoration: none;
  border-bottom: 1px dashed var(--accent-primary);
  transition: all 0.2s;
}

.message-bubble a:hover {
  color: #34d399;
  border-bottom-style: solid;
}

.message-bubble strong {
  font-weight: 600;
  color: var(--accent-primary); /* Highlight strong text slightly */
}

.message-bubble code {
  background: rgba(255, 255, 255, 0.1);
  padding: 2px 5px;
  border-radius: 4px;
  font-family: var(--font-mono); /* Ensure we have a mono font var or use standard */
  font-family: "JetBrains Mono", monospace;
  font-size: 0.9em;
  color: #e4e4e7;
}

.message-bubble table {
  width: 100%;
  border-collapse: collapse;
  margin: 16px 0;
  font-size: 0.95em;
}

.message-bubble th,
.message-bubble td {
  padding: 8px 12px;
  border: 1px solid var(--border-subtle);
  text-align: left;
}

.message-bubble th {
  background: rgba(255, 255, 255, 0.05);
  font-weight: 600;
  color: var(--text-primary);
}

.message-bubble tr:nth-child(even) {
  background: rgba(255, 255, 255, 0.02);
}

/* Input Nexus - Floating Glass */
.input-nexus {
  position: absolute;
  bottom: 20px;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  padding: 0 20px;
  z-index: var(--z-sticky);
}

.input-wrapper {
  width: 100%;
  max-width: 800px;
  background: rgba(30, 30, 35, 0.85);
  backdrop-filter: blur(16px);
  border: 1px solid var(--border-subtle);
  box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.4);
  border-radius: var(--radius-lg);
  padding: 12px 16px;
  display: flex;
  align-items: flex-end;
  gap: 12px;
  transition:
    box-shadow 0.2s,
    border-color 0.2s;
}

.input-wrapper:focus-within {
  border-color: var(--border-highlight);
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
}

textarea#message-input {
  flex: 1;
  background: transparent;
  border: none;
  color: var(--text-primary);
  font-family: inherit;
  font-size: 15px;
  padding: 8px 0;
  resize: none;
  max-height: 200px;
  outline: none;
}

textarea#message-input::placeholder {
  color: var(--text-tertiary);
}

.action-btn,
.send-btn {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  padding: 8px;
  border-radius: var(--radius-sm);
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.action-btn:hover,
.send-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.send-btn.active {
  background: var(--accent-primary);
  color: white;
}

.input-hint {
  position: absolute;
  bottom: -24px;
  font-size: 11px;
  color: var(--text-tertiary);
}

/* Extensions Grid */
.extensions-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: var(--space-4);
  padding: 20px;
  width: 100%;
}

.view-header {
  padding: 20px;
  width: 100%;
  border-bottom: 1px solid var(--border-subtle);
  background: rgba(255, 255, 255, 0.02);
}

.view-title {
  font-size: 20px;
  margin-bottom: 4px;
}

.extension-card {
  background: var(--bg-surface);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-subtle);
  padding: 20px;
  border-radius: var(--radius-md);
  transition:
    transform 0.2s,
    border-color 0.2s;
  cursor: pointer;
  display: flex;
  flex-direction: column;
}

.extension-card:hover {
  transform: translateY(-2px);
  border-color: var(--border-highlight);
  background: rgba(50, 50, 60, 0.5);
}

.ext-name {
  font-size: 16px;
  color: var(--accent-primary);
  margin-bottom: 8px;
}

.ext-desc {
  flex: 1;
  font-size: 13px;
  line-height: 1.5;
  margin-bottom: 16px;
  color: var(--text-secondary);
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
}

.ext-meta {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--text-tertiary);
  padding-top: 12px;
  border-top: 1px solid var(--border-subtle);
}

/* Logs View */
.header-actions {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.btn-secondary {
  background: transparent;
  border: 1px solid var(--border-subtle);
  color: var(--text-secondary);
  border-radius: var(--radius-sm);
  padding: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.btn-secondary:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  border-color: var(--border-highlight);
}

.toggle-wrapper {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-secondary);
  cursor: pointer;
}



/* Thinking Process - Refined & Subtle */
.thinking-process {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  margin: var(--space-3) 0;
  max-width: 90%;
  overflow: hidden;
  backdrop-filter: blur(2px);
  font-size: 13px;
}

.thinking-header {
  padding: 6px 10px;
  background: rgba(255, 255, 255, 0.02);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 12px;
  color: var(--text-tertiary);
}

.thinking-spinner,
.thinking-complete-icon {
  width: 12px;
  height: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.thinking-spinner {
  border: 1.5px solid var(--text-tertiary);
  border-top-color: var(--accent-primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.thinking-complete-icon {
  font-size: 10px;
}

.thinking-logs {
  padding: 0 10px 10px;
  max-height: 200px;
  overflow-y: auto;
  border-top: 1px solid rgba(255, 255, 255, 0.02);
}

.log-list {
  display: flex;
  flex-direction: column;
  gap: 2px;
  padding-top: 8px;
}

.log-item {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-tertiary);
  line-height: 1.4;
  display: flex;
  gap: 8px;
}

.log-item .timestamp {
  opacity: 0.5;
  flex-shrink: 0;
  white-space: nowrap;
}

.log-item .content {
  flex: 1;
}

.log-item.error .content {
  color: #f87171;
}
.log-item.success .content {
  color: var(--accent-primary);
}
.log-item.info .content {
  color: var(--accent-secondary);
}

.thinking-process:not(.expanded) .thinking-logs {
  display: none;
}

/* Modals */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: var(--z-modal);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.modal-overlay:not(.hidden) {
  opacity: 1;
  pointer-events: auto;
}

.modal {
  background: rgba(22, 22, 26, 0.95); /* Deeper, more solid background */
  border: 1px solid var(--border-highlight);
  border-radius: var(--radius-lg);
  width: 90%;
  max-width: 500px;
  max-height: 85vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  transform: translateY(20px);
  transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  overflow: hidden;
}

.modal-overlay:not(.hidden) .modal {
  transform: translateY(0);
}

.modal.large {
  max-width: 800px;
  height: 80vh;
}

.modal-header {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(255, 255, 255, 0.02);
}

.modal-header h3 {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
}

.close-btn {
  background: transparent;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: 4px;
  border-radius: var(--radius-sm);
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.close-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.modal-body {
  padding: 24px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.settings-group {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.group-title {
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-tertiary);
  font-weight: 600;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border-subtle);
  margin-bottom: 8px;
}

.field {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.field label {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-secondary);
}

.field input[type="text"],
.field input[type="password"],
.field select {
  background: rgba(0, 0, 0, 0.2);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  padding: 10px 12px;
  color: var(--text-primary);
  font-family: inherit;
  font-size: 14px;
  outline: none;
  transition: all 0.2s;
}

.field input:focus,
.field select:focus {
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.1);
  background: rgba(0, 0, 0, 0.3);
}

.field-hint {
  font-size: 12px;
  color: var(--text-tertiary);
  margin-top: 4px;
}

.field-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.field-info {
  flex: 1;
}

.field-desc {
  font-size: 13px;
  color: var(--text-tertiary);
}

/* Toggle Switch */
.toggle-switch {
  position: relative;
  width: 44px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--bg-surface);
  border: 1px solid var(--border-subtle);
  transition: 0.3s;
  border-radius: 24px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 2px;
  bottom: 2px;
  background-color: var(--text-secondary);
  transition: 0.3s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: var(--accent-primary);
  border-color: var(--accent-primary);
}

input:checked + .slider:before {
  transform: translateX(20px);
  background-color: white;
}

.modal-footer {
  padding: 20px 24px;
  border-top: 1px solid var(--border-subtle);
  display: flex;
  justify-content: flex-end;
  background: rgba(255, 255, 255, 0.02);
}

.btn-primary {
  background: var(--accent-primary);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: var(--radius-md);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.btn-primary:hover {
  filter: brightness(1.1);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

.btn-primary:disabled {
  opacity: 0.7;
  cursor: not-allowed;
  transform: none;
}

/* Toast Notifications */
.toast-container {
  position: fixed;
  bottom: 24px;
  right: 24px;
  z-index: var(--z-modal);
  display: flex;
  flex-direction: column;
  gap: 12px;
  pointer-events: none;
}

.toast {
  background: rgba(22, 22, 26, 0.95);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  padding: 12px 16px;
  min-width: 300px;
  box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: flex-start;
  gap: 12px;
  color: var(--text-primary);
  pointer-events: auto;
  opacity: 0;
  transform: translateY(10px) scale(0.95);
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.toast.visible {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.toast.success {
  border-left: 3px solid var(--accent-primary);
}
.toast.error {
  border-left: 3px solid #ef4444;
}
.toast.info {
  border-left: 3px solid var(--accent-secondary);
}

.toast-icon {
  margin-top: 2px;
  display: flex;
}

.toast.success .toast-icon {
  color: var(--accent-primary);
}
.toast.error .toast-icon {
  color: #ef4444;
}
.toast.info .toast-icon {
  color: var(--accent-secondary);
}

.toast-message {
  flex: 1;
  font-size: 14px;
  line-height: 1.5;
}

.toast-close {
  background: transparent;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: 0;
  margin-top: 2px;
  transition: color 0.2s;
  font-size: 18px;
  line-height: 1;
}

.toast-close:hover {
  color: var(--text-primary);
}

/* Custom Scrollbar for Code */
.code-block-wrapper ::-webkit-scrollbar {
  height: 8px;
  width: 8px;
}
.code-block-wrapper ::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
}
.code-block-wrapper ::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
}
.code-block-wrapper ::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* Code Preview (Live Generation) */
.code-preview-block {
  margin-top: 12px;
  border: 1px solid var(--accent-secondary);
  border-radius: var(--radius-sm);
  background: rgba(30, 30, 35, 0.5);
  overflow: hidden;
  animation: slide-in 0.3s ease-out;
}

@keyframes slide-in {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.code-preview-header {
  background: rgba(99, 102, 241, 0.1);
  padding: 6px 12px;
  border-bottom: 1px solid rgba(99, 102, 241, 0.2);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.code-preview-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--accent-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  display: flex;
  align-items: center;
  gap: 6px;
}

.code-preview-desc {
  font-size: 11px;
  color: var(--text-tertiary);
  max-width: 200px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.code-preview-content {
  padding: 12px;
  margin: 0;
  overflow-x: auto;
  font-family: "JetBrains Mono", monospace;
  font-size: 12px;
  line-height: 1.5;
  color: #d4d4d8;
}
